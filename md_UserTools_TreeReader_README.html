<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ToolApplication: TreeReader</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ToolApplication
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="classTreeReader.html">TreeReader</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A tool for reading in data from ROOT or ZEBRA files. Access to file data is provided by two means:</p><ol type="1">
<li>For ROOT files an <a class="el" href="classMTreeReader.html">MTreeReader</a> will be created and placed into the <a class="el" href="classDataModel.html#a6db42acc6c98cd31e937085a0b882a22" title="A map of MTreeReader pointers, used to read ROOT trees.">DataModel::Trees</a> map.</li>
<li>For SK files (ROOT or ZEBRA), <code>skread</code> and/or <code>skrawread</code> will be called to populate fortran common blocks. For SK ROOT files both means of data access will be available.</li>
</ol>
<p>Typically, one entry will be loaded per Execute call (i.e per ToolChain loop). Optionally, for SHE entries with a subsequent AFT entry, both SHE+AFT entries may be read together in one call. The SHE data will be loaded initially, but by calling 'LoadAFT' or 'LoadSHE' the user may access the desired data. See below for how to invoke these functions. The reader can be configured to return only SHE+AFT pairs (skipping SHE events without an associated AFT) or it may return all events, loading AFT data together with an SHE event only when it is available.</p>
<h1><a class="anchor" id="autotoc_md56"></a>
Configuration</h1>
<p>The following options are available. Defaults, when applicable, are given in parentheses. </p><div class="fragment"><div class="line">verbosity 1                                    # tool verbosity (1)</div>
<div class="line">readerName MyReader                            # the name to associate to this reader instance in the DataModel</div>
<div class="line">inputFile /path/to/an/input/file.root          # a single input file, ROOT or ZBS</div>
<div class="line">FileListName MyFileList                        # the name of a set of files prepared by the LoadFileList tool</div>
<div class="line">maxEntries 10                                  # max number of entries to process before stopping the ToolChain (-1)</div>
<div class="line">skFile 1                                       # whether to enable additional functionality for SK files (1)</div>
</div><!-- fragment --><p>When reading ROOT files the following options are also available: </p><div class="fragment"><div class="line">treeName MyTree                                # the name of the tree within the file</div>
<div class="line">firstEntry 10                                  # the first entry to read (0)</div>
</div><!-- fragment --><p>When enabling additional functionality for SK files the following options are also available: </p><div class="fragment"><div class="line">LUN 10                                         # LUN to assign to the file (10)</div>
<div class="line">SK_GEOMETRY 4                                  # which SK geometry this file relates to (4)</div>
<div class="line">skoptn 31,30,26,25                             # options describing what to load via skread/skrawread (31)</div>
<div class="line">skbadopt 23                                    # which classes of channels to mask (23)</div>
<div class="line">skbadchrun 42428                               # which run to use for bad ch list for MC / calibration data</div>
<div class="line">skreadMode 0                                   # which set of `skread` or `skrawread` to call (0)</div>
<div class="line">skipPedestals 1                                # whether to skip pedestal and status entries (1)</div>
<div class="line">readSheAftTogether 1                           # whether to read AFT data for associated SHE events together (0)</div>
<div class="line">onlySheAftPairs 1                              # whether to only return SHE+AFT pairs (0)</div>
<div class="line">skippedTriggers 1,2,3                          # skip entries in which any of the trigger bits in this list are set (none)</div>
<div class="line">allowedTriggers 18,19                          # return only entries with one of the trigger bits in this list set (none)</div>
</div><!-- fragment --><p>When processing SK ROOT files the following additional options are also available: </p><div class="fragment"><div class="line">skrootMode 0                                   # operation mode of the TreeManager (2)</div>
<div class="line">outputFile /path/to/an/output/file.root        # the output file, when using the TreeManager in root2root mode</div>
</div><!-- fragment --><p>Notes:</p><ul>
<li>default values are given above in parentheses. If none is given, the option is mandatory.</li>
<li>inputFile will take precedence over FileListName (only one is required). It supports a file path or glob.</li>
<li>skFile mode will be set to 1 when reading ZBS files, based on the file extention.</li>
<li>firstEntry should probably be left at 0 when in skFile mode, since event information is carried over by skread/skrawread, and event processing may fail if entries are not read sequentially from the first entry</li>
<li>if maxEntries is not given or less than 0, all entries in the file will be read.</li>
<li>skrootMode: 2=read, 1=write, 0=root2root copy.</li>
<li>skreadMode: on each entry call... 3=both <code>skrawread</code> and <code>skread</code>, 2=<code>skrawread</code> only, 1=<code>skread</code> only, 0=<code>auto</code> - both if input file has no MC branch, only <code>skread</code> otherwise.</li>
<li>if skoptn contains 25 (mask bad channels) but not 26 (get bad ch list based on current run number), then a reference run must be provided in skbadchrun. skoptn 26 cannot be used with MC data files. (see $SKOFL_ROOT/src/skrd/skoptn.F for all options)</li>
<li>LUN will only be respected if it is not already in use. Otherwise the next free LUN will be used. Assignments start from 10.</li>
<li>skipPedestals will load the next entry for which <code>skread</code> or <code>skrawread</code> did not return 3 or 4 (not pedestal or runinfo entry).</li>
<li>When reading ROOT files, only enable branches you intend to use. Specify a list of input branches as follows: <div class="fragment"><div class="line">StartInputBranchList</div>
<div class="line">branchA</div>
<div class="line">branchB</div>
<div class="line">branchC</div>
<div class="line">EndInputBranchList</div>
</div><!-- fragment --></li>
<li>this will disable all branches other than <code>branchA</code>, <code>branchB</code> and <code>branchC</code>.</li>
<li>for skroot files in <code>copy</code> mode, an output file will be created and entries may be copied from input to output file. Unused input branches should be disabled as above, but branches that are needed for processing but not desired in the output can be removed from the copy operation by listing only the desired output branches as follows: <div class="fragment"><div class="line">StartOutputBranchList</div>
<div class="line">branchA</div>
<div class="line">branchB</div>
<div class="line">EndOutputBranchList</div>
</div><!-- fragment --></li>
<li>in this case branches <code>branchA</code>,<code>branchB</code> and <code>branchC</code> will be read in and accessible, but the output file will only contain branches <code>branchA</code> and <code>branchB</code>.</li>
<li>outputFile is only applicable in skroot copy or write mode.</li>
<li>In write mode you will need to call <code>skroot_set_***</code> and <code>skroot_fill_tree_</code> functions as required. If you need to read inputs from another file, you will need to use another <a class="el" href="classTreeReader.html">TreeReader</a> instance.</li>
<li>N.B. The minimum set of active input branches for calling <a class="el" href="classlf__allfit.html">lf_allfit</a> seems to be:</li>
<li>SOFTWARETRG</li>
<li>EVENTHEADER</li>
<li>PEDESTALS</li>
<li>TQLIST</li>
<li>ODTQLIST</li>
<li>SPACERS</li>
<li>HEADER</li>
<li>TQAREAL</li>
<li>ATMPD</li>
<li>SLE</li>
</ul>
<p>skoptn values: </p><div class="fragment"><div class="line">31 : Read HEADER bank &amp; put it to skhead.h  (always required)</div>
<div class="line">30 : Read real data from TQREAL bank &amp; put it to sktq.h</div>
<div class="line">29 : Read T &amp; Q count from TQ bank &amp; put it to sktq.h</div>
<div class="line">27:  Set bad channel for ATMPD MC</div>
<div class="line">26 : Read bad channel information from the file &amp; put it to skbadc.h</div>
<div class="line">25 : Mask the bad channel</div>
<div class="line">24 : Mask ID-OD XTALK</div>
<div class="line">23 : Read water transparency info into skwaterlen.h</div>
<div class="line">22 : Read the pedestal data from PDST bank &amp; put it to skpdst.h</div>
<div class="line">20 : Read event without clearing previous event </div>
<div class="line">19 : Read Real data from VETO bank &amp; put it to skveto.h </div>
<div class="line">18 : Read TQ data from TQ bank &amp; put it to skveto.h</div>
<div class="line">17 : Read RWANTI bank &amp; put it to sktq.h regardless of header</div>
<div class="line">16 : Read TQSKZ &amp; TQSKAZ in SKREAD</div>
<div class="line">15 : Timing correction (TMQ) by Ikeda-san</div>
<div class="line">14 : Do not remove q&lt;0 hits for OD (SK IV only)</div>
</div><!-- fragment --><p>skbadopt bits: (from skbadcC.h) </p><div class="fragment"><div class="line">no bits (skbadopt 0): mask all kinds of bad channels (used for high energy events, e.g. muon reconstruction)</div>
<div class="line">bit 0: mask badch.dat</div>
<div class="line">bit 1: mask dead ID PMTs (criterion 1)</div>
<div class="line">bit 2: mask dead ID PMTs (criterion 2)</div>
<div class="line">bit 3: mask ID noisy PMTs (should NOT be enabled for lowe event subtigger search or lowe reconstruction)</div>
<div class="line">bit 4: mask OD PMTs</div>
<div class="line">bit 5: mask ID HK PMTs</div>
<div class="line">uppermost bit (skbadopt -1): mask only badch.00* and inner HK PMTs</div>
</div><!-- fragment --><p> usual lowe option is 23: 10111; mask everything except noisy ID PMTs (says this masks OD PMTs, but from what? they're still read into the appropriate common blocks...) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
